
clear all
restoredefaultpath

addpath('~/Documents/MATLAB/fieldtrip/')
ft_defaults


%%

datapath='~/Dropbox/Teaching/Salzburg/PhD/Fieldtrip_2020/Data/';
fifname_max='19890425HRWL_block*_trans_sss.fif';

nn = dir(fullfile(datapath, fifname_max));

%%
cfg=[];
cfg.dataset=fullfile(datapath, nn(1).name);
cfg.trialdef.eventtype  = '?';
ft_definetrial(cfg);

%%

evt = ft_read_event(fullfile(datapath, nn(1).name));
evt = ft_filter_event(evt, 'type', 'Trigger');

%%
tmp=struct2cell(evt);
evt_ind=cell2mat(tmp(3,:));
evt_sample=cell2mat(tmp(2,:));

evt_ind = evt_ind(2:end);
evt_sample = evt_sample(2:end);

%%

hdr=ft_read_header(fullfile(datapath, nn(1).name));
ind_trigger=find(evt_ind == 2 | evt_ind == 4 | evt_ind == 5 | evt_ind == 8 | evt_ind == 9);

pointspre = hdr.Fs * 1;
pointspost = hdr.Fs * 1.5;

trl_manual = [evt_sample(ind_trigger)-pointspre; evt_sample(ind_trigger)-pointspost; -ones(1, length(ind_trigger))*pointspre];
trl_manual = trl_manual'; %this is basic trl matrix with epoch infos
trl_manual


